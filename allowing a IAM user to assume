How to allow a IAM user to assume a role

To allow an **IAM user** to assume a role, you need to set up trust between the role and the user. Hereâ€™s a step-by-step guide on how to achieve this:

---

### **Step 1: Create a Role with the Trust Policy**
1. **Go to the AWS Management Console**:
   - Navigate to **IAM > Roles**.
2. **Create a Role**:
   - Click on **Create role**.
   - Select **Another AWS account** as the trusted entity if the user is in another account. For users in the same account, select **Custom trust policy**.
3. **Set up the Trust Policy**:
   - Modify the trust policy to allow the specific IAM user or group to assume the role. The trust policy should look like this:
     ```json
     {
       "Version": "2012-10-17",
       "Statement": [
         {
           "Effect": "Allow",
           "Principal": {
             "AWS": "arn:aws:iam::<Account-ID>:user/<User-Name>"
           },
           "Action": "sts:AssumeRole"
         }
       ]
     }
     ```
   - Replace `<Account-ID>` and `<User-Name>` with the appropriate AWS account ID and IAM user name.
4. **Attach Permissions to the Role**:
   - Add the desired policies (e.g., EC2 Full Access).

---

### **Step 2: Allow the User to Assume the Role**
1. Go to the **IAM Console**.
2. Select the IAM **User**.
3. Attach a policy to the user that allows them to assume the role. For example:
   ```json
   {
     "Version": "2012-10-17",
     "Statement": [
       {
         "Effect": "Allow",
         "Action": "sts:AssumeRole",
         "Resource": "arn:aws:iam::<Account-ID>:role/<Role-Name>"
       }
     ]
   }
   ```
   - Replace `<Account-ID>` and `<Role-Name>` with the appropriate values.

---

### **Step 3: Assume the Role as an IAM User**
The IAM user can assume the role using one of these methods:

#### **A. AWS Management Console**:
1. Log in as the IAM user.
2. Navigate to the **Switch Role** option in the top-right corner of the AWS Management Console.
3. Enter the **Account ID** and **Role Name**, then click **Switch Role**.

#### **B. AWS CLI**:
1. Use the `aws sts assume-role` command to get temporary credentials:
   ```bash
   aws sts assume-role \
     --role-arn "arn:aws:iam::<Account-ID>:role/<Role-Name>" \
     --role-session-name "SessionName"
   ```
2. Use the returned temporary credentials (`AccessKeyId`, `SecretAccessKey`, `SessionToken`) to interact with AWS services.

#### **C. SDK or API**:
- Use the AWS SDK for your programming language of choice to call `AssumeRole` and retrieve temporary credentials.

---

### Example Policy Flow:
- **Trust Policy**: Attached to the role, allowing the IAM user to assume it.
- **Inline Policy**: Attached to the IAM user, allowing them to invoke `sts:AssumeRole`.

---
